---
title: "ðŸ“š í”„ë ˆìž„ì›Œí¬ ì—†ëŠ” í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ _ ë Œë”ë§"
date: "2023-03-15"
description: "í”„ë ˆìž„ì›Œí¬ ì—†ëŠ” í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ë„ì„œ ìŠ¤í„°ë”” í›„ ì •ë¦¬í•œ ë‚´ìš©"
tags: ["study", "js", "react", "framework"]
thumbnail: "thumbnail.png"
---

## DOM

---

DOMì´ëž€ ì›¹ íŽ˜ì´ì§€ì— ëŒ€í•œ ì¸í„°íŽ˜ì´ìŠ¤ë¡œ, ì—¬ëŸ¬ í”„ë¡œê·¸ëž¨ë“¤ì´ íŽ˜ì´ì§€ì˜ ë‚´ìš©, êµ¬ì¡°, ìŠ¤íƒ€ì¼ì„ ì½ê³  ì¡°ìž‘í•  ìˆ˜ ìžˆëŠ” APIë¥¼ ì œê³µí•œë‹¤. ì•„ëž˜ì˜ Critical Rendering Pathë¥¼ í†µí•´ ì•Œ ìˆ˜ ìžˆë“¯ì´, HTML íŽ˜ì´ì§€ëŠ” íŠ¸ë¦¬ë¡œ êµ¬ì„±ë˜ë©° ê° ë…¸ë“œì˜ ì†ì„±ì„ ë³€ê²½í•˜ê¸° ìœ„í•´ì„œëŠ” `ì„ íƒìž(selector)`ë¥¼ ì‚¬ìš©í•œë‹¤.

### Critical Rendering Path

ë¸Œë¼ìš°ì €ê°€ íŽ˜ì´ì§€ ì´ˆê¸° ì¶œë ¥ì„ ìœ„í•´ HTML ë°ì´í„°ë¥¼ í™”ë©´ì— ë Œë”ë§ í•˜ê¸° ê¹Œì§€ì˜ ê³¼ì •ì„ ì˜ë¯¸í•œë‹¤.

1. HTML ë°ì´í„°ë¥¼ íŒŒì‹±í•˜ì—¬ DOM íŠ¸ë¦¬ ìƒì„±
2. ìŠ¤íƒ€ì¼ ì‹œíŠ¸ë¥¼ íŒŒì‹±í•˜ì—¬ CSSOM ìƒì„±
3. ë…ë¦½ëœ ê°ì²´ì¸ DOMê³¼ CSSOMì„ ë³‘í•©í•˜ì—¬ ë Œë” íŠ¸ë¦¬ êµ¬ì¶•
4. Layout: ê° ìš”ì†Œì— ëŒ€í•œ ìœ„ì¹˜ì™€ í¬ê¸°ë¥¼ ê³„ì‚°í•˜ì—¬ í™”ë©´ì˜ ë ˆì´ì•„ì›ƒ êµ¬ì„± (Reflow)
5. Paint(Repaint)

## ë Œë”ë§ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

---

ì›¹ìš© ë Œë”ë§ ì—”ì§„ì„ ì„¤ê³„í•  ë•ŒëŠ” ê°€ë…ì„±, ìœ ì§€ ê´€ë¦¬ì„±, ì„±ëŠ¥ì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•´ì•¼ í•œë‹¤.
ëŒ€í‘œì ì¸ ì›¹ ì„±ëŠ¥ ì¸¡ì • ë°©ë²•ìœ¼ë¡œ ì´ˆ ë‹¹ í”„ë ˆìž„ ìˆ˜(FPS)ë¥¼ í™•ì¸í•˜ëŠ” ë°©ë²•ì´ ìžˆë‹¤.

!["ì´ˆ ë‹¹ í”„ë ˆìž„ ìˆ˜"](/images/posts/frameworkless_frontend_2/fps.png)

FPSëŠ” GPUì—ì„œ ì‚¬ìš©í•˜ëŠ” ë©”ëª¨ë¦¬ì˜ ì–‘ì„ í™•ì¸í•  ìˆ˜ ìžˆìœ¼ë©°, ì• ë‹ˆë©”ì´ì…˜ì´ë‚˜ ë§ˆìš°ìŠ¤ ì›€ì§ìž„ì´ ëŠìž„ì—…ì‹± ë¶€ë“œëŸ½ê²Œ ë™ìž‘í•˜ëŠ”ê°€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œê°€ ëœë‹¤. ë³´í†µ 60fps ì´ìƒì´ë©´ ë¬´ë‚œížˆ ë™ìž‘í•œë‹¤ê³  íŒë‹¨í•˜ë©°, í¬ë¡¬ ê°œë°œìž ë„êµ¬ ë˜ëŠ” `stats.js` ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“±ì„ ì‚¬ìš©í•˜ì—¬ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤.

## ë Œë”ë§ í•¨ìˆ˜

---

ìˆœìˆ˜ í•¨ìˆ˜ë¡œ ìš”ì†Œë¥¼ ë Œë”ë§ í•œë‹¤ëŠ” ê²ƒì€ DOM ìš”ì†Œê°€ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ìƒíƒœì—ë§Œ ì˜ì¡´í•œë‹¤ëŠ” ê²ƒì´ë‹¤.

```js
// ì–´ë– í•œ state ê°’ì„ í•¨ìˆ˜ì— ë„£ì—ˆì„ ë•Œ ê°™ì€ ë·°ê°€ ë°˜í™˜ëœë‹¤
view = ð‘“(state);
```

ìˆœìˆ˜ í•¨ìˆ˜ ë Œë”ë§ ê³¼ì •ì„ ì˜ˆì œì™€ í•¨ê»˜ ì‚´íŽ´ë³´ì•˜ë‹¤.

1. `view.js` :
   ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” íƒ€ê²Ÿ DOM ìš”ì†Œì™€ stateë¥¼ ì¸ìžê°’ìœ¼ë¡œ ë°›ìŒ -> íƒ€ê²Ÿ DOMì„ ë³µì œí•˜ì—¬ stateë¥¼ í™œìš©í•˜ì—¬ ì—…ë°ì´íŠ¸ -> ë³€ê²½ì‹œ ìƒˆ ë…¸ë“œ ë°˜í™˜

2. `index.js` :
   ëª¨ë“  DOM ì¡°ìž‘ ë˜ëŠ” ì• ë‹ˆë©”ì´ì…˜ì€ `requestAnimationFrame`ì„ ê¸°ë°˜ìœ¼ë¡œ í•œë‹¤. ë©”ì¸ ìŠ¤ë ˆë“œë¥¼ ì°¨ë‹¨í•˜ì§€ ì•Šê³ , ì´ë²¤íŠ¸ ë£¨í”„ì—ì„œ ìŠ¤ì¼€ì¤„ë§ ë˜ê¸° ì§ì „ì— repaintê°€ ì‹¤í–‰ëœë‹¤.

   !["ë Œë”ë§ í”„ë¡œì„¸ìŠ¤"](/images/posts/frameworkless_frontend_2/rendering.png)

## ë™ì  ë°ì´í„° ë Œë”ë§

---

ìƒˆë¡œìš´ ë°ì´í„°ê°€ ìžˆì„ë•Œë§ˆë‹¤ `root element ìƒì„± -> element ìƒì„± -> ìƒˆë¡œ ìƒì„±ëœ ìš”ì†Œë¡œ ë³€ê²½` ìž‘ì—…ì„ ê±°ì¹˜ë©´, ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í¬ê¸°ê°€ í´ìˆ˜ë¡ ë” ë§Žì€ ì„±ëŠ¥ ì €í•˜ê°€ ë°œìƒí•  ê²ƒì´ë‹¤.

### ê°€ìƒ DOM

ì„ ì–¸ì  ë Œë”ë§ ì—”ì§„ì˜ ì„±ëŠ¥ì„ ê°œì„ ì‹œí‚¤ëŠ” ë°©ì‹ì´ë‹¤.
UIê°€ ë©”ëª¨ë¦¬ì— ì €ìž¥ë˜ê³ , ì‹¤ì œ í™”ë©´ì— ë Œë”ë§ë˜ì–´ ìžˆëŠ” DOMê³¼ ë™ê¸°í™”ë˜ì–´ ìžˆë‹¤ê°€ `diff` ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ ì ë§Œ ì°¾ì•„ë‚´ì–´ **ì‹¤ì œ DOMì„ ìƒˆë¡œìš´ DOMìœ¼ë¡œ êµì²´í•˜ëŠ” ê°€ìž¥ ë¹ ë¥¸ ë°©ë²•**ì„ ì°¾ì•„ë‚¸ë‹¤.

ìžì„¸í•œ ë‚´ìš©ì€ React ê³µì‹ ë¬¸ì„œì˜ [reconcilationì—](https://ko.reactjs.org/docs/reconciliation.html) ëŒ€í•œ ì„¤ëª…ì„ ì°¸ê³ 

### ê°€ìƒ DOM êµ¬í˜„

```js
const render = () => {
  window.requestAnimationFrame(() => {
    const main = document.querySelector(".todoapp");
    const newMain = registry.renderRoot(main, state);
    applyDiff(document.body, main, newMain);
  });
};
```

`applyDiff(í˜„ìž¬DOM, ì‹¤ì œDOM, ê°€ìƒDOM)`

- ìƒˆ ë…¸ë“œê°€ ì—†ìŒ -> ì‹¤ì œ ë…¸ë“œë¥¼ ì‚­ì œ
- ì‹¤ì œ ë…¸ë“œê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ì§€ë§Œ ê°€ìƒ ë…¸ë“œê°€ ì¡´ìž¬ -> ë¶€ëª¨ ë…¸ë“œì— ì¶”ê°€
- ë‘ ë…¸ë“œ ëª¨ë‘ ì •ì˜ -> ë‘ ë…¸ë“œì˜ ì°¨ì´ í™•ì¸
  - ì†ì„±ì˜ ìˆ˜ê°€ ë‹¤ë¥¸ê°€?
  - í•˜ë‚˜ ì´ìƒì˜ ì†ì„±ì´ ë³€ê²½ë˜ì—ˆëŠ”ê°€?
  - ë…¸ë“œì—ëŠ” ìžì‹ì´ ì—†ìœ¼ë©°, textContentê°€ ë‹¤ë¥¸ê°€?

### Component Functions

1. ì„ ì–¸ì  ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬ ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§ í•  ê²ƒì¸ì§€ ìžë™ìœ¼ë¡œ ê²°ì •í•˜ë„ë¡ ì„¤ê³„í•´ì•¼ í•¨

- ë°ì´í„° ì†ì„±
  - HTMLì€ ë°ì´í„°ì— ëŒ€í•œ í™•ìž¥ ê°€ëŠ¥ì„±ì„ ì—¼ë‘ì— ë‘ê³  ì„¤ê³„ë˜ì—ˆê¸° ë•Œë¬¸ì— `data-*` í˜•íƒœë¡œ ì¶”ê°€ì ì¸ DOM ì†ì„±ì„ ì €ìž¥í•  ìˆ˜ ìžˆê²Œí•¨
  - ì ‘ê·¼ ë°©ì‹: `document.getElementById(â€™electricâ€™).dataset.ì†ì„±`
  - ì˜ˆì œì—ì„œëŠ” `data-component='ì»´í¬ë„ŒíŠ¸ëª…'` ìœ¼ë¡œ ì§€ì •í•˜ì—¬ ì‚¬ìš©í•¨
- ë ˆì§€ìŠ¤íŠ¸ë¦¬
  - ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìžˆëŠ” ëª¨ë“  **ì»´í¬ë„ŒíŠ¸ì˜ ì¸ë±ìŠ¤**
  - ì˜ˆì œì—ì„œëŠ” data-component ê°’ê³¼ ì¸ë±ìŠ¤ì˜ ê°’ì„ ì¼ì¹˜ì‹œì¼œ í˜¸ì¶œí•¨
  ```js
  const registry = {
    todos: todosView,
    counter: counterView,
    filters: filtersView,
  };
  ```

2. ì´ ëª¨ë“  ë°©ì‹ì€ root ì»¨í…Œì´ë„ˆ í¬í•¨ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì— ì ìš©ë˜ì–´ì•¼ í•˜ë©°, ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œë„ ë™ì¼í•œ ë¡œì§ ì‚¬ìš© ê°€ëŠ¥ (ìž¬ì‚¬ìš©ì„±)

3. ìˆœìˆ˜ í•¨ìˆ˜ë¥¼ ìƒì†ë°›ì„ ìˆ˜ ìžˆë„ë¡ ì»´í¬ë„ŒíŠ¸ë¥¼ ëž˜í•‘í•˜ëŠ” ê³ ì°¨ í•¨ìˆ˜ ìƒì„±

- ê¸°ì¡´ì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ì ¸ì™€ ë™ì¼í•œ ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸ë¥¼ ë°˜í™˜í•¨
- [ data-component ì†ì„±ì„ ê°€ì§„ ëª¨ë“  DOM ìš”ì†Œ íƒìƒ‰ â†’ ë°œê²¬ â†’ ìžì‹ ì»´í¬ë„ŒíŠ¸ í˜¸ì¶œ â†’ ìžì‹ ì»´í¬ë„ŒíŠ¸ëŠ” ë™ì¼í•œ í•¨ìˆ˜ë¡œ ëž˜í•‘ ] â†’ ìž¬ê·€í•˜ì—¬ ë§ˆì§€ë§‰ ì»´í¬ë„ŒíŠ¸ê¹Œì§€ ëª¨ë‘ íƒìƒ‰
- ì°¸ê³ ìžë£Œ: [ì¼ê¸‰ ê°ì²´](https://ko.wikipedia.org/wiki%EC%9D%BC%EA%B8%89_%EA%B0%9D%EC%B2%B4), [ì»¤ë§](https://ko.javascript.info/currying-partials), [HOF](https://ko.wikipedia.org/wiki/%EA%B3%A0%EC%B0%A8_%ED%95%A8%EC%88%98)

```js
// ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì ‘ê·¼ìž ë©”ì„œë“œ
const add = (name, component) => {
  registry[name] = renderWrapper(component);
};
```

4. ìµœì´ˆ DOM ìš”ì†Œì—ì„œì˜ ë Œë”ë§ ì‹œìž‘ì„ ìœ„í•´ ë£¨íŠ¸ë¥¼ ë Œë”ë§ í•˜ëŠ” ë©”ì„œë“œ `renderRoot` ì¶”ê°€

   ```jsx
   const renderRoot = (root, state) => {
     const cloneComponent = (root) => {
       return root.cloneNode(true);
     };
     return renderWrapper(cloneComponent)(root, state);
   };
   ```

5. ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ í˜¼í•©í•˜ì—¬ ë Œë”ë§

   ```jsx
   registry.add("todos", todosView);
   registry.add("counter", countersView);
   registry.add("filters", filtersView);

   const state = {
     todos: getTodos(),
     currentFilter: "All",
   };

   window.requestAnimationFrame(() => {
     const main = document.querySelector(".todoapp");
     const newMain = registry.renderRoot(main, state);
     main.replaceWith(newMain);
   });
   ```
